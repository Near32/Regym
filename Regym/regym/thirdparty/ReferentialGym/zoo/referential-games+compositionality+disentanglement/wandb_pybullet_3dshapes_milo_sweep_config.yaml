project: RG_COMPO+DIS 
entity: near3213
program: train_wandb.py
command:
        - ${env}
        - /scratch/kyd500/rg_env/bin/python
        - ${program}
        - ${args}
method: bayes
metric:
        name: PerEpoch/descriptive_test/repetition0/comm_round0/referential_game_accuracy/Mean  
        goal: maximize
parameters:
        parent_folder:
                values: [./3dhapes_milo_sweep]
        use_cuda:
                values: [True]
        seed:
                values: [10]
        obverter_nbr_games_per_round:
                values: [2, 10, 20]
        obverter_threshold_to_stop_message_generation:
                values: [0.95]
        obverter_sampling_round_alternation_only:
                values: [True]
        batch_size:
                values: [8, 16, 32, 64]
        mini_batch_size:
                values: [64]
        vae_lambda:
                values: [0.0]
        vae_factor_gamma:
                values: [0.0]
        resizeDim:
                values: [64]
        arch:
                values: [BN+BetaVAEEncoderOnly3x3]
        emb_dropout_prob:
                values: [0.0]
        dropout_prob:
                values: [0.0, 0.5]
        max_sentence_length:
                values: [10]
        vocab_size:
                values: [10]
        epoch:
                values: [501]
        symbol_processing_nbr_hidden_units:
                values: [128]
        symbol_embedding_size:
                values: [64]
        distractor_sampling:
                values: [uniform]
        nbr_distractors:
                values: [3, 31]        
        add_discriminative_test:
                values: [True]
        nbr_discriminative_test_distractors:
                values: [7]
        add_descriptive_test:
                values: [True]

        obverter_use_decision_head:
                values: [True]
        obverter_nbr_head_outputs:
                values: [2]
        agent_loss_type:
                values: [NLL, Hinge]
        graphtype:
                values: [obverter]
        synthetic_progression_end:
                values: [100]

        metric_epoch_period:
                values: [100]
        nbr_train_points:
                values: [500]
        nbr_eval_points:
                values: [500]
        metric_batch_size:
                values: [64]
        dis_metric_resampling:
                values: [True]
        metric_resampling:
                values: [True]
        metric_active_factors_only:
                values: [True]
        
        lr:
                values: [6.0e-4, 1.0e-3, 1.0e-4]
       
        verbose:
                values: [True]

        cultural_pressure_it_period:
                values: [100, 500, 1000, 2000]
        cultural_substrate_size:
                values: [1, 2, 5]
        cultural_reset_strategy:
                values: ["meta-oldestSL", "meta-uniformSL"]
        cultural_pressure_parameter_filtering_scheme:
                values: ["all", "language-model-only"]
        cultural_pressure_meta_learning_rate:
                values: [1.0e-1, 1.0e-2, 1.0e-3]
                
        agent_nbr_latent_dim:
                values: [32]
        vae_nbr_latent_dim:
                values: [32]
        
        descriptive_ratio:
                values: [0.0]
        descriptive:
                values: [True, False]
        shared_architecture:
                values: [True]
        with_DP_in_obverter_decision_head:
                values: [True, False] 
        with_BN_in_obverter_decision_head:
                values: [True, False]
        visual_context_consistent_obverter:
                values: [False]
        
        object_centric:
                values: [False, True]
        nb_3dshapespybullet_shapes:
                values: [10]
        nb_3dshapespybullet_colors: 
                values: [10]
        nb_3dshapespybullet_samples:
                values: [10]
        nb_3dshapespybullet_train_colors:
                values: [5]
        dataset:
                values: [3DShapesPyBullet]
        vae_gaussian:
                values: [False]
